package net.civeira.phylax.features.access.useridentity.domain;

import java.util.List;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import net.civeira.phylax.features.access.relyingparty.domain.RelyingPartyReference;
import net.civeira.phylax.features.access.role.domain.RoleReference;
import net.civeira.phylax.features.access.trustedclient.domain.TrustedClientReference;
import net.civeira.phylax.features.access.user.domain.UserReference;

class UserIdentityChangeSetUnitTest {

  /**
   * @autogenerated CachedGenerator
   */
  @Test
  @DisplayName("Test a entity reference contruction")
  void test_user_identity_change_set_builder() {
    UserIdentityChangeSet one = new UserIdentityChangeSet().uid("one").user(UserReference.of("one"))
        .relyingParty(RelyingPartyReference.of("one"))
        .trustedClient(TrustedClientReference.of("one"))
        .roles(List.of(Roles.builder().uid("one").role(RoleReference.of("one")).version(1).build()))
        .version(1).newUid();
    one.uid("two");
    Assertions.assertEquals("two", one.getUid().get(), "Value must equals to the assigned value");
    one.unset("uid");
    Assertions.assertFalse(one.getUid().isPresent(), "After unset, the valeue must be dissapear");
    Assertions.assertEquals(UserReference.of("one"), one.getUser().get(),
        "Value must equals to the intial value");
    one.user(UserReference.of("two"));
    Assertions.assertEquals(UserReference.of("two"), one.getUser().get(),
        "Value must equals to the assigned value");
    one.unset("user");
    Assertions.assertFalse(one.getUser().isPresent(), "After unset, the valeue must be dissapear");
    Assertions.assertEquals(RelyingPartyReference.of("one"), one.getRelyingParty().get(),
        "Value must equals to the intial value");
    one.relyingParty(RelyingPartyReference.of("two"));
    Assertions.assertEquals(RelyingPartyReference.of("two"), one.getRelyingParty().get(),
        "Value must equals to the assigned value");
    one.unset("relyingParty");
    Assertions.assertFalse(one.getRelyingParty().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(TrustedClientReference.of("one"), one.getTrustedClient().get(),
        "Value must equals to the intial value");
    one.trustedClient(TrustedClientReference.of("two"));
    Assertions.assertEquals(TrustedClientReference.of("two"), one.getTrustedClient().get(),
        "Value must equals to the assigned value");
    one.unset("trustedClient");
    Assertions.assertFalse(one.getTrustedClient().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(
        List.of(Roles.builder().uid("one").role(RoleReference.of("one")).version(1).build()),
        one.getRoles().get(), "Value must equals to the intial value");
    one.roles(List.of(Roles.builder().uid("two").role(RoleReference.of("two")).version(2).build()));
    Assertions.assertEquals(
        List.of(Roles.builder().uid("two").role(RoleReference.of("two")).version(2).build()),
        one.getRoles().get(), "Value must equals to the assigned value");
    one.unset("roles");
    Assertions.assertFalse(one.getRoles().isPresent(), "After unset, the valeue must be dissapear");
    Assertions.assertEquals(0, one.getVersion().get(), "Value must equals to the intial value");
    one.version(2);
    Assertions.assertEquals(2, one.getVersion().get(), "Value must equals to the assigned value");
    one.unset("version");
    Assertions.assertFalse(one.getVersion().isPresent(),
        "After unset, the valeue must be dissapear");
  }
}
