package net.civeira.phylax.features.access.user.domain;

import java.time.LocalDateTime;
import java.time.ZoneId;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

import net.civeira.phylax.common.crypto.AesCipherService;
import net.civeira.phylax.features.access.tenant.domain.TenantReference;

class UserChangeSetUnitTest {

  /**
   * @autogenerated CachedGenerator
   */
  @Test
  @DisplayName("Test a entity reference contruction")
  void test_user_change_set_builder() {
    AesCipherService cypher = Mockito.mock(AesCipherService.class);
    UserChangeSet one = UserChangeSet.builder().uid("one").tenant(TenantReference.of("one"))
        .name("one").password("one").email("one")
        .wellcomeAt(LocalDateTime
            .of(1980, 8, 20, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime())
        .enabled(true).approve(UserApproveOptions.UNVERIFIED).temporalPassword(true)
        .useSecondFactors(true).secondFactorSeed("one").blockedUntil(LocalDateTime
            .of(1980, 8, 20, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime())
        .provider("one").version(1).newUid().build();
    one.setUid("two");
    Assertions.assertEquals("two", one.getUid().get().getUid(),
        "Value must equals to the assigned value");
    one.unset("uid");
    Assertions.assertFalse(one.getUid().isPresent(), "After unset, the valeue must be dissapear");
    Assertions.assertEquals(TenantReference.of("one"), one.getTenant().get().getTenant(),
        "Value must equals to the intial value");
    one.setTenant(TenantReference.of("two"));
    Assertions.assertEquals(TenantReference.of("two"), one.getTenant().get().getTenant(),
        "Value must equals to the assigned value");
    one.unset("tenant");
    Assertions.assertFalse(one.getTenant().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one", one.getName().get().getName(),
        "Value must equals to the intial value");
    one.setName("two");
    Assertions.assertEquals("two", one.getName().get().getName(),
        "Value must equals to the assigned value");
    one.unset("name");
    Assertions.assertFalse(one.getName().isPresent(), "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one", one.getPassword().get().getPlainPassword(cypher),
        "Value must equals to the intial value");
    one.setPassword("two");
    Assertions.assertEquals("two", one.getPassword().get().getPlainPassword(cypher),
        "Value must equals to the assigned value");
    one.unset("password");
    Assertions.assertFalse(one.getPassword().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one", one.getEmail().get().getEmail().get(),
        "Value must equals to the intial value");
    one.setEmail("two");
    Assertions.assertEquals("two", one.getEmail().get().getEmail().get(),
        "Value must equals to the assigned value");
    one.unset("email");
    Assertions.assertFalse(one.getEmail().isPresent(), "After unset, the valeue must be dissapear");
    Assertions.assertEquals(
        LocalDateTime.of(1980, 8, 20, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getWellcomeAt().get().getWellcomeAt().get(), "Value must equals to the intial value");
    one.setWellcomeAt(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime());
    Assertions.assertEquals(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getWellcomeAt().get().getWellcomeAt().get(), "Value must equals to the assigned value");
    one.unset("wellcomeAt");
    Assertions.assertFalse(one.getWellcomeAt().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(true, one.getEnabled().get().isEnabled(),
        "Value must equals to the intial value");
    one.setEnabled(false);
    Assertions.assertEquals(false, one.getEnabled().get().isEnabled(),
        "Value must equals to the assigned value");
    one.unset("enabled");
    Assertions.assertFalse(one.getEnabled().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(UserApproveOptions.UNVERIFIED,
        one.getApprove().get().getApprove().get(), "Value must equals to the intial value");
    one.setApprove(UserApproveOptions.PENDING);
    Assertions.assertEquals(UserApproveOptions.PENDING, one.getApprove().get().getApprove().get(),
        "Value must equals to the assigned value");
    one.unset("approve");
    Assertions.assertFalse(one.getApprove().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(true, one.getTemporalPassword().get().isTemporalPassword(),
        "Value must equals to the intial value");
    one.setTemporalPassword(false);
    Assertions.assertEquals(false, one.getTemporalPassword().get().isTemporalPassword(),
        "Value must equals to the assigned value");
    one.unset("temporalPassword");
    Assertions.assertFalse(one.getTemporalPassword().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(true, one.getUseSecondFactors().get().isUseSecondFactors(),
        "Value must equals to the intial value");
    one.setUseSecondFactors(false);
    Assertions.assertEquals(false, one.getUseSecondFactors().get().isUseSecondFactors(),
        "Value must equals to the assigned value");
    one.unset("useSecondFactors");
    Assertions.assertFalse(one.getUseSecondFactors().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one",
        one.getSecondFactorSeed().get().getPlainSecondFactorSeed(cypher).get(),
        "Value must equals to the intial value");
    one.setSecondFactorSeed("two");
    Assertions.assertEquals("two",
        one.getSecondFactorSeed().get().getPlainSecondFactorSeed(cypher).get(),
        "Value must equals to the assigned value");
    one.unset("secondFactorSeed");
    Assertions.assertFalse(one.getSecondFactorSeed().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(
        LocalDateTime.of(1980, 8, 20, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getBlockedUntil().get().getBlockedUntil().get(),
        "Value must equals to the intial value");
    one.setBlockedUntil(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime());
    Assertions.assertEquals(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getBlockedUntil().get().getBlockedUntil().get(),
        "Value must equals to the assigned value");
    one.unset("blockedUntil");
    Assertions.assertFalse(one.getBlockedUntil().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one", one.getProvider().get().getProvider().get(),
        "Value must equals to the intial value");
    one.setProvider("two");
    Assertions.assertEquals("two", one.getProvider().get().getProvider().get(),
        "Value must equals to the assigned value");
    one.unset("provider");
    Assertions.assertFalse(one.getProvider().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(0, one.getVersion().get().getVersion().get(),
        "Value must equals to the intial value");
    one.setVersion(2);
    Assertions.assertEquals(2, one.getVersion().get().getVersion().get(),
        "Value must equals to the assigned value");
    one.unset("version");
    Assertions.assertFalse(one.getVersion().isPresent(),
        "After unset, the valeue must be dissapear");
  }
}
