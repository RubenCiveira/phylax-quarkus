package net.civeira.phylax.features.access.useraccesstemporalcode.domain;

import java.time.LocalDateTime;
import java.time.ZoneId;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.mockito.Mockito;

import net.civeira.phylax.common.crypto.AesCipherService;
import net.civeira.phylax.features.access.user.domain.UserReference;

class UserAccessTemporalCodeChangeSetUnitTest {

  /**
   * @autogenerated CachedGenerator
   */
  @Test
  @DisplayName("Test a entity reference contruction")
  void test_user_access_temporal_code_change_set_builder() {
    AesCipherService cypher = Mockito.mock(AesCipherService.class);
    UserAccessTemporalCodeChangeSet one = UserAccessTemporalCodeChangeSet.builder().uid("one")
        .user(UserReference.of("one")).tempSecondFactorSeed("one")
        .tempSecondFactorSeedExpiration(LocalDateTime.of(1980, 8, 20, 0, 0)
            .atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime())
        .failedLoginAttempts(1).registerCode("one").registerCodeUrl("one")
        .registerCodeExpiration(LocalDateTime.of(1980, 8, 20, 0, 0)
            .atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime())
        .recoveryCode("one").recoveryCodeExpiration(LocalDateTime.of(1980, 8, 20, 0, 0)
            .atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime())
        .version(1).newUid().build();
    one.setUid("two");
    Assertions.assertEquals("two", one.getUid().get().getUid(),
        "Value must equals to the assigned value");
    one.unset("uid");
    Assertions.assertFalse(one.getUid().isPresent(), "After unset, the valeue must be dissapear");
    Assertions.assertEquals(UserReference.of("one"), one.getUser().get().getUser(),
        "Value must equals to the intial value");
    one.setUser(UserReference.of("two"));
    Assertions.assertEquals(UserReference.of("two"), one.getUser().get().getUser(),
        "Value must equals to the assigned value");
    one.unset("user");
    Assertions.assertFalse(one.getUser().isPresent(), "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one",
        one.getTempSecondFactorSeed().get().getPlainTempSecondFactorSeed(cypher).get(),
        "Value must equals to the intial value");
    one.setTempSecondFactorSeed("two");
    Assertions.assertEquals("two",
        one.getTempSecondFactorSeed().get().getPlainTempSecondFactorSeed(cypher).get(),
        "Value must equals to the assigned value");
    one.unset("tempSecondFactorSeed");
    Assertions.assertFalse(one.getTempSecondFactorSeed().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(
        LocalDateTime.of(1980, 8, 20, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getTempSecondFactorSeedExpiration().get().getTempSecondFactorSeedExpiration().get(),
        "Value must equals to the intial value");
    one.setTempSecondFactorSeedExpiration(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime());
    Assertions.assertEquals(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getTempSecondFactorSeedExpiration().get().getTempSecondFactorSeedExpiration().get(),
        "Value must equals to the assigned value");
    one.unset("tempSecondFactorSeedExpiration");
    Assertions.assertFalse(one.getTempSecondFactorSeedExpiration().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(1, one.getFailedLoginAttempts().get().getFailedLoginAttempts().get(),
        "Value must equals to the intial value");
    one.setFailedLoginAttempts(2);
    Assertions.assertEquals(2, one.getFailedLoginAttempts().get().getFailedLoginAttempts().get(),
        "Value must equals to the assigned value");
    one.unset("failedLoginAttempts");
    Assertions.assertFalse(one.getFailedLoginAttempts().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one", one.getRegisterCode().get().getRegisterCode().get(),
        "Value must equals to the intial value");
    one.setRegisterCode("two");
    Assertions.assertEquals("two", one.getRegisterCode().get().getRegisterCode().get(),
        "Value must equals to the assigned value");
    one.unset("registerCode");
    Assertions.assertFalse(one.getRegisterCode().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one", one.getRegisterCodeUrl().get().getRegisterCodeUrl().get(),
        "Value must equals to the intial value");
    one.setRegisterCodeUrl("two");
    Assertions.assertEquals("two", one.getRegisterCodeUrl().get().getRegisterCodeUrl().get(),
        "Value must equals to the assigned value");
    one.unset("registerCodeUrl");
    Assertions.assertFalse(one.getRegisterCodeUrl().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(
        LocalDateTime.of(1980, 8, 20, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getRegisterCodeExpiration().get().getRegisterCodeExpiration().get(),
        "Value must equals to the intial value");
    one.setRegisterCodeExpiration(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime());
    Assertions.assertEquals(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getRegisterCodeExpiration().get().getRegisterCodeExpiration().get(),
        "Value must equals to the assigned value");
    one.unset("registerCodeExpiration");
    Assertions.assertFalse(one.getRegisterCodeExpiration().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals("one", one.getRecoveryCode().get().getRecoveryCode().get(),
        "Value must equals to the intial value");
    one.setRecoveryCode("two");
    Assertions.assertEquals("two", one.getRecoveryCode().get().getRecoveryCode().get(),
        "Value must equals to the assigned value");
    one.unset("recoveryCode");
    Assertions.assertFalse(one.getRecoveryCode().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(
        LocalDateTime.of(1980, 8, 20, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getRecoveryCodeExpiration().get().getRecoveryCodeExpiration().get(),
        "Value must equals to the intial value");
    one.setRecoveryCodeExpiration(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime());
    Assertions.assertEquals(
        LocalDateTime.of(1981, 9, 6, 0, 0).atZone(ZoneId.of("Europe/Madrid")).toOffsetDateTime(),
        one.getRecoveryCodeExpiration().get().getRecoveryCodeExpiration().get(),
        "Value must equals to the assigned value");
    one.unset("recoveryCodeExpiration");
    Assertions.assertFalse(one.getRecoveryCodeExpiration().isPresent(),
        "After unset, the valeue must be dissapear");
    Assertions.assertEquals(0, one.getVersion().get().getVersion().get(),
        "Value must equals to the intial value");
    one.setVersion(2);
    Assertions.assertEquals(2, one.getVersion().get().getVersion().get(),
        "Value must equals to the assigned value");
    one.unset("version");
    Assertions.assertFalse(one.getVersion().isPresent(),
        "After unset, the valeue must be dissapear");
  }
}
