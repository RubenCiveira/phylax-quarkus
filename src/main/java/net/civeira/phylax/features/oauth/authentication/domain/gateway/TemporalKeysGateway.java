/* @autogenerated */
package net.civeira.phylax.features.oauth.authentication.domain.gateway;

import java.util.Optional;

import io.quarkus.runtime.annotations.RegisterForReflection;
import lombok.Builder;
import lombok.RequiredArgsConstructor;
import net.civeira.phylax.features.oauth.authentication.domain.model.AuthRequest;
import net.civeira.phylax.features.oauth.authentication.domain.model.AuthenticationData;
import net.civeira.phylax.features.oauth.client.domain.model.ClientDetails;

public interface TemporalKeysGateway {

  @Builder
  @RequiredArgsConstructor
  @RegisterForReflection
  public static class TemporalAuthCode {
    public final AuthenticationData data;
    public final ClientDetails clientDetails;
    public final AuthRequest request;
  }

  String getCurrentKey();

  Optional<String> verifyToken(String token);

  String registerTemporalAuthCode(TemporalAuthCode code);

  Optional<TemporalAuthCode> retrieveTemporalAuthCode(String code);
}
