/* @autogenerated */
package net.civeira.phylax.features.oauth.authentication.application.spi;

import java.time.Instant;
import java.util.List;

import net.civeira.phylax.features.oauth.authentication.domain.model.AuthRequest;
import net.civeira.phylax.features.oauth.authentication.domain.model.AuthenticationChallege;
import net.civeira.phylax.features.oauth.authentication.domain.model.AuthenticationData;
import net.civeira.phylax.features.oauth.authentication.domain.model.AuthenticationMode;
import net.civeira.phylax.features.oauth.authentication.domain.model.AuthenticationResult;
import net.civeira.phylax.features.oauth.client.domain.model.ClientDetails;

public interface UserLoginSpi {
  AuthenticationResult validatePreAuthenticated(AuthRequest request, String username,
      ClientDetails client, List<AuthenticationChallege> challenges);

  AuthenticationResult validateUserData(AuthRequest request, String username, String password,
      ClientDetails client, List<AuthenticationChallege> challenges);

  default AuthenticationResult validateMfa(AuthRequest request, String username, String secreto,
      ClientDetails client, List<AuthenticationChallege> challenges) {
    AuthenticationData data = new AuthenticationData();
    data.setMode(AuthenticationMode.MFA);
    data.setUsername(username);
    data.setTenant(request.getTenant());
    data.setTime(Instant.now());
    return AuthenticationResult.right(data);
  }
}
