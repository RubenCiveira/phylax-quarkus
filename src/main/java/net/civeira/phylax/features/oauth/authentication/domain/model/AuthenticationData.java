/* @autogenerated */
package net.civeira.phylax.features.oauth.authentication.domain.model;

import java.time.Instant;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import io.quarkus.runtime.annotations.RegisterForReflection;
import lombok.Data;

@Data
@RegisterForReflection
public class AuthenticationData {
  private String uid;
  /**
   * El nombre del acceso
   */
  private String username;
  /**
   * La lista de roles del usuario
   */
  private List<String> roles = new ArrayList<>();
  /**
   * La lista de audiencias
   */
  private List<String> audiences = new ArrayList<>();

  private String tenant;

  private Map<String, Object> details = new HashMap<>();

  private AuthenticationMode mode;

  private Instant time;

  public void addRolesTo(String audience, List<String> names) {
    names.stream().forEach(name -> {
      roles.add(("*".equals(audience) ? "" : audience + ".") + name);
    });
  }
}
