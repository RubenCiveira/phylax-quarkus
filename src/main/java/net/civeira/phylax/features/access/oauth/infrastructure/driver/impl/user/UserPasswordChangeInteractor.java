/* @autogenerated */
package net.civeira.phylax.features.access.oauth.infrastructure.driver.impl.user;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.transaction.Transactional;
import lombok.RequiredArgsConstructor;
import net.civeira.phylax.features.access.oauth.application.usecase.UserLoginUsecase;
import net.civeira.phylax.features.oauth.authentication.application.spi.UserPasswordChangeSpi;
import net.civeira.phylax.features.oauth.authentication.domain.model.AuthRequest;

@Transactional
@ApplicationScoped
@RequiredArgsConstructor
public class UserPasswordChangeInteractor implements UserPasswordChangeSpi {
  private final UserLoginUsecase users;

  @Override
  public boolean updatePassword(AuthRequest request, String username, ChPassRequest chRequest) {
    return users.updatePassword(request, username, chRequest.getOldPassword(),
        chRequest.getNewPassword());
  }

  @Override
  public boolean allowUpdatePassword(AuthRequest request, String username) {
    return true;
  }
}
