package net.civeira.phylax.features.access.apikeyclient.application.policy;

import jakarta.enterprise.event.Observes;
import net.civeira.phylax.common.security.Actor;
import net.civeira.phylax.features.access.apikeyclient.application.usecase.retrieve.ApiKeyClientRetrieveAllowDecision;

public class RetrieveOnlyForRoot {

  /**
   * Constant for rootAdmin field
   *
   * @autogenerated ConditionPolicyGenerator
   */
  private static final String ROL_ROOT_ADMIN = "root:admin";

  /**
   * @autogenerated ConditionPolicyGenerator
   * @param allowDecision
   */
  public void checkAllow(@Observes ApiKeyClientRetrieveAllowDecision allowDecision) {
    Actor actor = allowDecision.getQuery().getActor();
    if (!actor.hasRole(ROL_ROOT_ADMIN)) {
      allowDecision.deny("Retrieve only for root");
    }
  }
}
