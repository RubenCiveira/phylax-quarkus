/* @autogenerated */
package net.civeira.phylax.features.access.oauth.infrastructure.driver.impl.rbac;

import java.util.List;

import jakarta.enterprise.context.ApplicationScoped;
import jakarta.transaction.Transactional;
import lombok.RequiredArgsConstructor;
import net.civeira.phylax.features.access.oauth.application.usecase.ExportResourceScopesUsecase;
import net.civeira.phylax.features.access.oauth.application.usecase.RegisterResourceUsecase;
import net.civeira.phylax.features.oauth.rbac.application.spi.RbacStore;
import net.civeira.phylax.features.oauth.rbac.domain.PropertyList;
import net.civeira.phylax.features.oauth.rbac.domain.RoleGrant;
import net.civeira.phylax.features.oauth.rbac.domain.ScopeList;

@Transactional
@ApplicationScoped
@RequiredArgsConstructor
public class RbacStoreImpl implements RbacStore {
  private final RegisterResourceUsecase register;
  private final ExportResourceScopesUsecase exporter;

  @Override
  public void registerScopes(String relayParty, List<ScopeList> paramMap) {
    register.registerScopes(relayParty, paramMap);
  }

  @Override
  public void registerSchema(String relayParty, List<PropertyList> paramMap) {
    register.registerSchema(relayParty, paramMap);
  }

  @Override
  public List<RoleGrant> granted(String relayParty) {
    return exporter.granted(relayParty);
  }

}
