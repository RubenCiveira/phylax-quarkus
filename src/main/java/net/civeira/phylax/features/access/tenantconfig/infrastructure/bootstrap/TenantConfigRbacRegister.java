package net.civeira.phylax.features.access.tenantconfig.infrastructure.bootstrap;

import java.util.List;

import io.quarkus.runtime.StartupEvent;
import jakarta.annotation.Priority;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.enterprise.event.Observes;
import lombok.RequiredArgsConstructor;
import net.civeira.phylax.common.security.Rbac;
import net.civeira.phylax.common.security.scope.FieldDescription;
import net.civeira.phylax.common.security.scope.Kind;
import net.civeira.phylax.common.security.scope.ResourceDescription;
import net.civeira.phylax.common.security.scope.ScopeDescription;

@ApplicationScoped
@RequiredArgsConstructor
public class TenantConfigRbacRegister {

  /**
   * @autogenerated RegisterGeneratorGenerator
   */
  private static final ResourceDescription RESOURCE =
      ResourceDescription.builder().name("tenant-config").description("tenant-config").build();

  /**
   * @autogenerated RegisterGeneratorGenerator
   */
  private final Rbac rbac;

  /**
   * @autogenerated RegisterGeneratorGenerator
   * @param ev
   */
  void registerResource(@Observes @Priority(10) final StartupEvent ev) {
    rbac.registerResourceAction(RESOURCE, ScopeDescription.builder().kind(Kind.READ).name("list")
        .description("list").required(List.of()).build());
    rbac.registerResourceAction(RESOURCE,
        ScopeDescription.builder().kind(Kind.READ).name("retrieve").description("list").build());
    rbac.registerResourceAction(RESOURCE, ScopeDescription.builder().kind(Kind.WRITE).name("create")
        .description("list").required(List.of()).build());
    rbac.registerResourceAction(RESOURCE, ScopeDescription.builder().kind(Kind.WRITE).name("update")
        .description("list").required(List.of()).build());
    rbac.registerResourceAction(RESOURCE, ScopeDescription.builder().kind(Kind.WRITE).name("delete")
        .description("list").required(List.of()).build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("uid")
        .description("A number to identify the db record").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("tenant")
        .description("The name to identify the account.").build());
    rbac.registerResourceField(RESOURCE,
        FieldDescription.builder().name("innerLabel")
            .description("Tenant could use these field to label the application for the users")
            .build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("forceMfa")
        .description("El force mfa de tenant config").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("allowRegister")
        .description("El allow register de tenant config").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("enableRegisterUsers")
        .description("El enable register users de tenant config").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("wellcomeEmail")
        .description("Email send to the enabled user").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("registerdEmail")
        .description("El registerd email de tenant config").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("disabledUserEmail")
        .description("Email send when a user is disabled").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("enabledUserEmail")
        .description("Email send when a user is enabled").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("allowRecoverPass")
        .description("El allow recover pass de tenant config").build());
    rbac.registerResourceField(RESOURCE, FieldDescription.builder().name("recoverPassEmail")
        .description("Email send to the user to recover the password").build());
    rbac.registerResourceField(RESOURCE,
        FieldDescription.builder().name("version").description(
            "Campo con el n√∫mero de version de tenant config para controlar bloqueos optimistas")
            .build());
  }
}
