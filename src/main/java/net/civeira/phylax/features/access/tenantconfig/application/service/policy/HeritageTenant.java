package net.civeira.phylax.features.access.tenantconfig.application.service.policy;

import jakarta.enterprise.event.Observes;
import net.civeira.phylax.common.security.Actor;
import net.civeira.phylax.features.access.tenant.TenantReference;
import net.civeira.phylax.features.access.tenantconfig.application.service.visibility.TenantConfigPresetProposal;

public class HeritageTenant {

  /**
   * Constant for root field
   *
   * @autogenerated FormulaPolicyGenerator
   */
  private static final String CLAIM_ROOT = "root";

  /**
   * @autogenerated FormulaPolicyGenerator
   * @param builder
   */
  public void calculate(@Observes TenantConfigPresetProposal builder) {
    Actor actor = builder.getInteraction().getActor();
    if (!"true".equals(actor.getClaim(CLAIM_ROOT))) {
      builder.peek(dto -> dto.setTenant(TenantReference.of(actor.getTenant().orElse(null))));
    }
  }
}
