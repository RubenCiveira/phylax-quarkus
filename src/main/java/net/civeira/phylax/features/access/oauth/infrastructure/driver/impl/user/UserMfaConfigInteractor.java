/* @autogenerated */
package net.civeira.phylax.features.access.oauth.infrastructure.driver.impl.user;

import java.util.Locale;
import java.util.Optional;

import jakarta.activation.DataSource;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.transaction.Transactional;
import lombok.RequiredArgsConstructor;
import net.civeira.phylax.features.access.oauth.application.usecase.MfaConfigUsecase;
import net.civeira.phylax.features.oauth.authentication.application.spi.UserMfaConfigSpi;
import net.civeira.phylax.features.oauth.authentication.domain.model.AuthRequest;

@Transactional
@ApplicationScoped
@RequiredArgsConstructor
public class UserMfaConfigInteractor implements UserMfaConfigSpi {
  private final MfaConfigUsecase config;

  @Override
  public Optional<DataSource> configQr(AuthRequest request, String username, Locale locale) {
    return config.configQr(request.getTenant(), username, request.getAudiences(), locale);
  }

  @Override
  public boolean requireImage(AuthRequest request, String username) {
    return true;
  }

  @Override
  public boolean validateOtpConfig(AuthRequest request, String username, String code) {
    return config.validateOtpConfig(request.getTenant(), username, request.getAudiences(), code);
  }
}
