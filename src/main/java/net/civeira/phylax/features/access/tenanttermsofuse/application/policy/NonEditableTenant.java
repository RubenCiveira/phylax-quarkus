package net.civeira.phylax.features.access.tenanttermsofuse.application.policy;

import jakarta.enterprise.event.Observes;
import net.civeira.phylax.common.security.Actor;
import net.civeira.phylax.features.access.tenanttermsofuse.application.visibility.TenantTermsOfUseFixedFieldsCheck;

public class NonEditableTenant {

  /**
   * Constant for root field
   *
   * @autogenerated VisibilityPolicyGenerator
   */
  private static final String CLAIM_ROOT = "root";

  /**
   * @autogenerated VisibilityPolicyGenerator
   * @param fixed
   */
  public void fixedFields(@Observes TenantTermsOfUseFixedFieldsCheck fixed) {
    Actor actor = fixed.getQuery().getActor();
    if (!"true".equals(actor.getClaim(CLAIM_ROOT))) {
      fixed.add("tenant");
    }
  }
}
