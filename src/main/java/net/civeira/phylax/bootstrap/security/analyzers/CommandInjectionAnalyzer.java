/* @autogenerated */
package net.civeira.phylax.bootstrap.security.analyzers;

import java.util.regex.Pattern;

import jakarta.enterprise.context.ApplicationScoped;
import net.civeira.phylax.bootstrap.security.MaliciousInjectionRiskAnalizer;

@ApplicationScoped
public class CommandInjectionAnalyzer implements MaliciousInjectionRiskAnalizer {
  private static final Pattern COMMAND_INJECTION_PATTERN = Pattern.compile(
      "(?i)(\\b(ls|cat|rm|netstat|sudo|bash|sh|python|perl)\\b\\s*(&&|\\||;|>|>>)|(;|&&)\\s*(ls|cat|rm|sudo|bash|sh|python|perl))");

  @Override
  public int analyze(String input) {
    return COMMAND_INJECTION_PATTERN.matcher(input).find() ? 5 : 0;
  }
}
