/* @autogenerated */
package net.civeira.phylax.bootstrap.security.analyzers;

import java.util.regex.Pattern;

import jakarta.enterprise.context.ApplicationScoped;
import net.civeira.phylax.bootstrap.security.MaliciousInjectionRiskAnalyzer;

@ApplicationScoped
public class SqlInjectionAnalyzer implements MaliciousInjectionRiskAnalyzer {
  private static final Pattern SQL_INJECTION_PATTERN = Pattern.compile(
      "(?i)\\b(SELECT|UNION|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|MERGE|CALL)\\b\\s+[^\\w\\s]*[\\w\\s]+(['\";]|(--|#))?");

  @Override
  public int analyze(String input) {
    return SQL_INJECTION_PATTERN.matcher(input).find() ? 5 : 0;
  }

}
