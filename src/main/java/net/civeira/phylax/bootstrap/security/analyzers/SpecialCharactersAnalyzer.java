/* @autogenerated */
package net.civeira.phylax.bootstrap.security.analyzers;

import java.util.regex.Pattern;

import jakarta.enterprise.context.ApplicationScoped;
import net.civeira.phylax.bootstrap.security.MaliciousInjectionRiskAnalizer;

@ApplicationScoped
public class SpecialCharactersAnalyzer implements MaliciousInjectionRiskAnalizer {
  private static final Pattern SPECIAL_CHARACTERS_PATTERN =
      Pattern.compile("(%[0-9a-fA-F]{2}|\\\\x[0-9a-fA-F]{2})");

  @Override
  public int analyze(String input) {
    return SPECIAL_CHARACTERS_PATTERN.matcher(input).find() ? 3 : 0;
  }

}
