/* @autogenerated */
package net.civeira.phylax.common.value.validation.validators;

import java.util.regex.Pattern;

import net.civeira.phylax.common.value.validation.ValidationResult;
import net.civeira.phylax.common.value.validation.Validator;

/**
 * Validator for email addresses. This class ensures that a given email string follows a valid email
 * format.
 */
public class EmailValidator implements Validator<String> {
  private final String errorMessage;

  /**
   * Constructs an EmailValidator with a specified error message.
   *
   * @param errorMessage The error message to return when validation fails.
   */
  public EmailValidator(String errorMessage) {
    this.errorMessage = errorMessage;
  }

  /**
   * Validates whether the given email string is in a valid format.
   *
   * @param email The email string to validate.
   * @return A ValidationResult indicating success or failure.
   */
  @Override
  public ValidationResult validate(String email) {
    final Pattern emailPattern =
        Pattern.compile("^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$");

    if (email == null || email.isEmpty()) {
      return new ValidationResult(errorMessage);
    }

    if (!emailPattern.matcher(email).matches()) {
      return new ValidationResult(errorMessage);
    }

    return new ValidationResult();
  }
}
