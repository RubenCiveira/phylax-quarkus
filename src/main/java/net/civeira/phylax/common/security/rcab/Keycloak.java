/* @autogenerated */
package net.civeira.phylax.common.security.rcab;

import org.eclipse.microprofile.config.inject.ConfigProperty;

import io.quarkus.arc.properties.IfBuildProperty;
import jakarta.enterprise.context.ApplicationScoped;
import lombok.RequiredArgsConstructor;
import net.civeira.phylax.common.security.Actor;
import net.civeira.phylax.common.security.RbacStore;
import net.civeira.phylax.common.security.scope.FieldDescription;
import net.civeira.phylax.common.security.scope.FieldGrantList;
import net.civeira.phylax.common.security.scope.ResourceDescription;
import net.civeira.phylax.common.security.scope.ScopeAllowList;
import net.civeira.phylax.common.security.scope.ScopeDescription;

@ApplicationScoped
@IfBuildProperty(name = "mp.rcab.model", stringValue = "keycloak")
@RequiredArgsConstructor
public class Keycloak implements RbacStore {
  private final String KIND = "keycloak";
  private final @ConfigProperty(name = "mp.rcab.model") String model;

  @Override
  public boolean isActive() {
    return KIND.equals(model);
  }

  @Override
  public void registerResourceAction(ResourceDescription resource, ScopeDescription action) {}

  @Override
  public void registerResourceField(ResourceDescription resource, FieldDescription field) {}

  @Override
  public ScopeAllowList checkRoleScopes(Actor actor) {
    return null;
  }

  @Override
  public FieldGrantList checkRoleProperties(Actor actor) {
    return null;
  }

}
