/* @autogenerated */
package net.civeira.phylax.common.infrastructure.audit;

import java.time.ZonedDateTime;
import java.util.Map;

import io.quarkus.runtime.annotations.RegisterForReflection;
import lombok.Builder;
import lombok.Data;

/**
 * Represents an audited operation with actor, entity, and tracing metadata.
 *
 * Each audit event captures who performed an action, when it happened, and what changed. The
 * structure is designed for storage and later inspection by administrators. It supports correlation
 * with traces and request context for debugging. Instances are typically persisted by
 * {@link AuditWriteService}.
 */
@Data
@Builder
@RegisterForReflection
public class AuditEvent {
  // Traceid
  private final String traceId;
  // Traceid
  private final String spanId;
  // e.g., "enable", "delete", "update"
  private final String operation;
  // e.g., "enable"
  private final String usecase;
  // e.g., "ApiKeyClient"
  private final String entityType;
  // ID of the entity affected
  private final String entityId;
  // Optional: previous state
  private final Map<String, String> oldValue;
  // Optional: new state
  private final Map<String, String> newValue;
  // Actor name
  private final String performedBy;
  // Tenant context
  private final String tenant;
  // Time of the operation
  private final ZonedDateTime timestamp;
  // Request path or command
  private final String sourceRequest;
  // IP
  private final String remoteAddress;
  // Optional client info
  private final String remoteApplication;
  // Optional device info
  private final String remoteDevice;
  // Claims from the actor (JWT, etc.)
  private final Map<String, String> claims;
}
